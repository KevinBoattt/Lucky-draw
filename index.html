
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Advanced Lucky Draw üéØ</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
      transition: background-color 0.3s, color 0.3s;
    }
    .container {
      max-width: 700px;
      margin: 60px auto;
      padding: 20px;
      border-radius: 10px;
      background: white;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }
    textarea, input[type=number] {
      width: 90%;
      font-size: 16px;
      padding: 10px;
      margin-top: 10px;
    }
    button {
      margin: 10px 5px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }
    .spin { background-color: #007bff; color: white; }
    .reset { background-color: #dc3545; color: white; }
    .theme-toggle { background-color: #343a40; color: white; }
    .shuffle { background-color: #28a745; color: white; }
    #result {
      font-size: 1.8em;
      margin-top: 20px;
      color: green;
    }
    #history {
      margin-top: 30px;
      text-align: left;
      max-height: 150px;
      overflow-y: auto;
    }
    #history h3 {
      margin-bottom: 5px;
    }
    .dark-mode {
      background-color: #1e1e1e;
      color: #f1f1f1;
    }
    .dark-mode .container {
      background: #2c2c2c;
    }
    .dark-mode textarea,
    .dark-mode input[type=number] {
      background-color: #444;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ Advanced Lucky Draw App</h1>
    <p>Enter names (comma-separated):</p>
    <textarea id="nameInput">Alice,Bob,Charlie,Diana,Ethan,Fiona</textarea><br>
    <p>Max winners allowed (optional):</p>
    <input type="number" id="maxWinners" placeholder="e.g. 3"><br>
    <button class="spin" onclick="startDraw()">Spin</button>
    <button class="shuffle" onclick="shuffleNames()">Shuffle</button>
    <button class="reset" onclick="resetGame()">Reset</button>
    <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
    <div id="result"></div>
    <div id="history">
      <h3>üèÖ Winner History:</h3>
      <ul id="winnerList"></ul>
    </div>
    <audio id="drumroll" src="https://www.soundjay.com/misc/sounds/bell-ringing-01.mp3"></audio>
    <audio id="winnerSound" src="https://www.soundjay.com/human/sounds/applause-01.mp3"></audio>
  </div>

  <script>
    let winners = [];
    let isDark = false;

    function launchConfetti() {
      confetti({ particleCount: 200, spread: 70, origin: { y: 0.6 } });
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function shuffleNames() {
      const input = document.getElementById("nameInput");
      let names = input.value.split(",").map(n => n.trim()).filter(n => n);
      names = shuffle(names);
      input.value = names.join(", ");
      alert("Names shuffled!");
    }

    function startDraw() {
      const input = document.getElementById("nameInput").value;
      let max = parseInt(document.getElementById("maxWinners").value) || Infinity;
      let names = input.split(",").map(n => n.trim()).filter(n => n && !winners.includes(n));

      if (winners.length >= max) {
        alert("Maximum number of winners reached.");
        return;
      }

      if (names.length === 0) {
        alert("No more unique names left to draw.");
        return;
      }

      const drumroll = document.getElementById("drumroll");
      const winnerSound = document.getElementById("winnerSound");
      drumroll.play();

      let result = document.getElementById("result");
      result.innerHTML = "Spinning...";
      let index = 0;
      let spins = 30;
      let interval = setInterval(() => {
        result.innerHTML = names[index % names.length];
        index++;
        spins--;
        if (spins === 0) {
          clearInterval(interval);
          const winner = names[Math.floor(Math.random() * names.length)];
          result.innerHTML = `üéä Winner: ${winner} üèÜ`;
          winners.push(winner);
          updateHistory();
          launchConfetti();
          drumroll.pause();
          drumroll.currentTime = 0;
          winnerSound.play();
        }
      }, 100);
    }

    function updateHistory() {
      const list = document.getElementById("winnerList");
      list.innerHTML = "";
      winners.forEach((w, i) => {
        const li = document.createElement("li");
        li.textContent = `${i + 1}. ${w}`;
        list.appendChild(li);
      });
    }

    function resetGame() {
      winners = [];
      document.getElementById("result").innerHTML = "";
      document.getElementById("winnerList").innerHTML = "";
      alert("Game has been reset.");
    }

    function toggleTheme() {
      document.body.classList.toggle("dark-mode");
      isDark = !isDark;
    }
  </script>
</body>
</html>
